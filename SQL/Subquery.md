# 서브쿼리(Subquery)
- 하나의 SQL문 안에 포함되어 있는 또 다른 SQL문
- 서브쿼리는 메인쿼리의 칼럼 모두 사용 가능, 메인쿼리에게 칼럼 전달 불가능
- 메인 쿼리는 서브쿼리의 칼럼 사용 불가능, 서브쿼리에게 칼럼 전달 가능
- **서브쿼리 내에서는 ```ORDER BY```절 사용 불가능**

<BR>

## 반환 형태에 따른 서브쿼리
- 단일행 서브쿼리
    - 서브쿼리의 실행 결과가 항상 1건 이하인 서브쿼리
    - 항상 비교 연산자와 함께 사용 ( =,<,<=,> 등 )
- 다중행 서브쿼리
    - 서브쿼리의 실행 결과가 여러 건인 서브쿼리
    - 다중행 비교 연산자와 함께 사용 ( ```IN, ALL, ANY, SOME, EXISTS``` )
- 다중칼럼 서브쿼리
    - 서브쿼리의 실행 결과로 여러 칼럼 반환
    - 메인쿼리의 조건 절에 여러 칼럼 동시에 비교 가능
    - **서브쿼리와 메인쿼리의 칼럼 수와 순서가 동일해야 함**

<BR>

## ```EXISTS```문 서브쿼리
- EXISTS문은 서브쿼리의 결과가 참이라면 결과집합에 포함
```SQL
SELECT
FROM

WHERE [NOT] EXISTS (···)
-- EXISTS 앞에 NOT을 추가하면 서브쿼리의 결과가 참이 아닌것을 반환
···
```

<BR>
<BR>

# 서브쿼리의 종류와 특징
## ```SELECT```절 (스칼라 서브쿼리)
- 스칼라 서브쿼리는 결과 행의 건수가 1건 이하여야만 SQL 에러가 발생하지 않는다.
```SQL
SELECT (···)
···
```

## ```FROM```절 (인라인뷰 서브쿼리)
- 메인 SQL문에서 인라인뷰 서브쿼리가 출력한 칼럼 혹은 값을 사용 가능
- 인라인뷰 서브쿼리 내부에서는 메인 쿼리의 칼럼이나 값 사용 불가능
```SQL
SELECT
FROM (···)
···
```

## ```WHERE```절
```SQL
SELECT
FROM
WHERE (···)
···
```

## ```HAVING```절
```SQL
SELECT
FROM
WHERE
[GROUP BY]
HAVING [칼럼명 >= ](···)
···
```

## ```INSERT```문의 ```VALUES```절
```SQL
INSERT [칼럼명]
VALUES ('값', (···), ···)
```

## ```UPDATE```문의 ```SET```절
```SQL
UPDATE 
SET [칼럼명] = (···)
```

<BR><BR>

# 뷰(VIEW)
- 뷰는 ```SQL문(SELECT문)```을 뷰로 생성해놓고, 해당 뷰만 호출하면 뷰 내부에 있는 ```SQL문(SELECT문)```을 호출할 수 있는 역할
- **독립성**
    - 테이블 구조가 변경되어도 뷰를 사용하는 응용 프로그램은 변경하지 않아도 된다.
- **편리성**
    - 복잡한 질이를 뷰로 생성함으로써 관련 질의를 단순하게 작성 가능
    - 해당 형태의 SQL문을 자주 사용할 때 뷰 사용하면 편리
- **보안성**
    - 숨기고 싶은 민감한 정보가 존재한다면, 뷰를 생성할 때 해당 정보(칼럼)를 제외시키고 생성함으로써 정보 노출하지 않는다.

## 뷰 생성
```SQL
CREATE [OR REPLACE] VIEW [뷰 이름]
AS 

SELECT
FROM
[WHERE
GROUP BY
ORDER BY]
``` 
## 뷰 제거
```SQL
DROP VIEW [뷰 이름]
```